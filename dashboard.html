<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - Task Manager</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">

    <nav class="navbar">
        <div class="logo">TaskManager</div>

        <ul class="nav-links">
            <li><a href="#">My Tasks</a></li>
            <li><a href="#">Add Task</a></li>
            <li><a href="#">Profile</a></li>
        </ul>

        <div class="nav-btns">
            <a href="#" class="btn-outline" onclick="logout()">Logout</a>
        </div>
    </nav>

    <section class="hero">
        <div class="hero-content">

            <h1 id="welcomeText">Welcome, Student ğŸ‘‹</h1>
            <p>Here you can manage all your academic tasks.</p>

            <h3>Add New Task:</h3>

            <input type="text" id="taskInput" placeholder="Enter your task">
            <br><br>

            <input type="date" id="taskDate">
            <br><br>

            <button class="btn-primary" onclick="addTask()">Add Task</button>

            <h3>Your Tasks:</h3>
            <ul id="taskList"></ul>

        </div>

        <div class="hero-images">
            <img src="https://cdn-icons-png.flaticon.com/512/2991/2991148.png" class="hero-illustration">
        </div>
    </section>

</div>

<script>
// ================= DASHBOARD PROTECTION =================
if (localStorage.getItem("isLoggedIn") !== "true") {
    window.location.href = "login.html";
}

// ================= SHOW USER NAME =================
let user = JSON.parse(localStorage.getItem("user"));
if (user) {
    document.getElementById("welcomeText").innerText =
        "Welcome, " + user.name + " ğŸ‘‹";
}

// ================= LOGOUT FUNCTION =================
function logout() {
    localStorage.removeItem("isLoggedIn");
    window.location.href = "login.html";
}

// ================= LOAD TASKS =================
let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
displayTasks();
checkDeadlines();

// ================= ADD TASK WITH DEADLINE =================
function addTask() {
    let taskInput = document.getElementById("taskInput").value;
    let taskDate = document.getElementById("taskDate").value;

    if (taskInput === "" || taskDate === "") {
        alert("Please enter both task and deadline!");
        return;
    }

    let taskObj = {
        name: taskInput,
        date: taskDate
    };

    tasks.push(taskObj);
    localStorage.setItem("tasks", JSON.stringify(tasks));

    document.getElementById("taskInput").value = "";
    document.getElementById("taskDate").value = "";

    displayTasks();
}

// ================= DISPLAY TASKS WITH STATUS =================
function displayTasks() {
    let taskList = document.getElementById("taskList");
    taskList.innerHTML = "";

    let today = new Date().toISOString().split("T")[0];

    tasks.forEach((task, index) => {

        let status = "";

        if (task.date < today) {
            status = " âŒ Overdue";
        }
        else if (task.date === today) {
            status = " âš  Due Today";
        }
        else {
            status = " âœ… Upcoming";
        }

        let li = document.createElement("li");
        li.innerHTML =
            task.name + " ( " + task.date + " ) " + status +
            ` <button onclick="deleteTask(${index})">âŒ</button>`;

        taskList.appendChild(li);
    });
}

// ================= DELETE TASK =================
function deleteTask(index) {
    tasks.splice(index, 1);
    localStorage.setItem("tasks", JSON.stringify(tasks));
    displayTasks();
}

// ================= REMINDER SYSTEM =================
function checkDeadlines() {
    let today = new Date().toISOString().split("T")[0];

    let dueTodayTasks = tasks.filter(task => task.date === today);

    if (dueTodayTasks.length > 0) {
        alert("â° Reminder! You have tasks due today!");
    }
}
</script>

</body>
</html>
